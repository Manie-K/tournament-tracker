<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="jakarta.faces.html" xmlns:ui="jakarta.faces.facelets" xmlns:f="jakarta.faces.core">

<ui:composition template="/WEB-INF/template/main.xhtml">
    <f:metadata>
        <f:viewParam name="tournamentId" value="#{tournamentDetailView.tournamentId}"/>
        <f:viewAction action="#{tournamentDetailView.init}" />
    </f:metadata>

    <ui:define name="title">Tournament - Details</ui:define>
    <ui:define name="content">
        <f:loadBundle var="message" basename="goralczyk.maciej.entities.view.i18n.messages"/>
        <h:link outcome="tournament_list" value="#{message.backToTournamentList}" styleClass="btn" />

            <h2>#{message.tournamentDetails}</h2>
            <p><strong>#{message.id}:</strong> <h:outputText value="#{tournamentDetailView.tournamentId}"/></p>
            <p><strong>#{message.name}:</strong> <h:outputText value="#{tournamentDetailView.tournament.name}"/></p>
            <p><strong>#{message.location}:</strong> <h:outputText value="#{tournamentDetailView.tournament.location}"/></p>

            <h3>#{message.matches}</h3>

                    <h:dataTable id="matchesTable" value="#{tournamentDetailView.matches.matches}" var="match">

                        <h:column>
                            <f:facet name="header">#{message.id}</f:facet>
                            <h:outputText value="#{match.id}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">#{message.participantA}</f:facet>
                            <h:outputText value="#{empty match.participantAName ? 'No participant A' : match.participantAName}"/>
                        </h:column>
                        <h:column>
                            <f:facet name="header">#{message.action}</f:facet>

                            <h:link outcome="/match/match_detail" value="#{message.view}" styleClass="btn">
                                <f:param name="matchId" value="#{match.id}" />
                            </h:link>

                            <h:link outcome="/match/match_edit" value="#{message.edit}" styleClass="btn">
                                <f:param name="matchId" value="#{match.id}" />
                                <f:param name="tournamentId" value="#{tournamentDetailView.tournament.id}" />
                            </h:link>

                            <h:form style="display:inline;">
                                <h:commandButton value="#{message.delete}" styleClass="btn"
                                                 action="#{tournamentDetailView.deleteMatch(match.id)}">
                                    <f:ajax execute="@this" render=":matchesTable"/>
                                </h:commandButton>
                            </h:form>

                            <f:facet name="footer">
                                <h:button styleClass="btn" outcome="/match/match_add.xhtml"
                                          value="#{message.newMatch}"/>
                            </f:facet>
                        </h:column>
                    </h:dataTable>

    </ui:define>
</ui:composition>

</html>